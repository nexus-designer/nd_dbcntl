generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DB_CONNECTION_STR")
}

model User {
  id            BigInt  @id @default(autoincrement())
  name          String  @db.VarChar(32)
  email         String
  pwd_hash      String  @db.Char(60)
  session_token String? @db.VarChar(32)

  // Relations
  conversations Conversation[]
}

model Conversation {
  id      BigInt  @id @default(autoincrement())
  user_id BigInt
  title   String  @db.VarChar(32)
  waiting Boolean

  // Relations
  user User  @relation(fields: [user_id], references: [id])
  msgs Msg[]
}

model Msg {
  id BigInt @id @default(autoincrement())
  conversation_id BigInt
  index           Int
  from_bot        Boolean
  content         String  @db.Text
  media           String? @db.Char(32)

  // Relations
  conversation Conversation @relation(fields: [conversation_id], references: [id])
}
